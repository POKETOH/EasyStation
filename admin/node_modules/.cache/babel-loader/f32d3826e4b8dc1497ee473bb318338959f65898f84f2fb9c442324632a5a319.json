{"ast":null,"code":"import { defineComponent, ref, onMounted, watch } from 'vue';\nimport { notification } from \"ant-design-vue\";\nimport axios from \"axios\";\nimport { pinyin } from \"pinyin-pro\";\nimport TrainSelectView from \"@/components/train-select\";\nexport default defineComponent({\n  name: \"train-station-view\",\n  components: {\n    TrainSelectView\n  },\n  setup() {\n    const visible = ref(false);\n    let trainStation = ref({\n      id: undefined,\n      trainCode: undefined,\n      index: undefined,\n      name: undefined,\n      namePinyin: undefined,\n      inTime: undefined,\n      outTime: undefined,\n      stopTime: undefined,\n      km: undefined,\n      createTime: undefined,\n      updateTime: undefined\n    });\n    const trainStations = ref([]);\n    // 分页的三个属性名是固定的\n    const pagination = ref({\n      total: 0,\n      current: 1,\n      pageSize: 10\n    });\n    let loading = ref(false);\n    const columns = [{\n      title: '车次编号',\n      dataIndex: 'trainCode',\n      key: 'trainCode'\n    }, {\n      title: '站序',\n      dataIndex: 'index',\n      key: 'index'\n    }, {\n      title: '站名',\n      dataIndex: 'name',\n      key: 'name'\n    }, {\n      title: '站名拼音',\n      dataIndex: 'namePinyin',\n      key: 'namePinyin'\n    }, {\n      title: '进站时间',\n      dataIndex: 'inTime',\n      key: 'inTime'\n    }, {\n      title: '出站时间',\n      dataIndex: 'outTime',\n      key: 'outTime'\n    }, {\n      title: '停站时长',\n      dataIndex: 'stopTime',\n      key: 'stopTime'\n    }, {\n      title: '里程（公里）',\n      dataIndex: 'km',\n      key: 'km'\n    }, {\n      title: '操作',\n      dataIndex: 'operation'\n    }];\n    watch(() => trainStation.value.name, () => {\n      if (Tool.isNotEmpty(trainStation.value.name)) {\n        trainStation.value.namePinyin = pinyin(trainStation.value.name, {\n          toneType: 'none'\n        }).replaceAll(\" \", \"\");\n      } else {\n        trainStation.value.namePinyin = \"\";\n      }\n    }, {\n      immediate: true\n    });\n    const onAdd = () => {\n      trainStation.value = {};\n      visible.value = true;\n    };\n    const onEdit = record => {\n      trainStation.value = window.Tool.copy(record);\n      visible.value = true;\n    };\n    const onDelete = record => {\n      axios.delete(\"/business/admin/train-station/delete/\" + record.id).then(response => {\n        const data = response.data;\n        if (data.success) {\n          notification.success({\n            description: \"删除成功！\"\n          });\n          handleQuery({\n            page: pagination.value.current,\n            size: pagination.value.pageSize\n          });\n        } else {\n          notification.error({\n            description: data.message\n          });\n        }\n      });\n    };\n    const handleOk = () => {\n      axios.post(\"/business/admin/train-station/save\", trainStation.value).then(response => {\n        let data = response.data;\n        if (data.success) {\n          notification.success({\n            description: \"保存成功！\"\n          });\n          visible.value = false;\n          handleQuery({\n            page: pagination.value.current,\n            size: pagination.value.pageSize\n          });\n        } else {\n          notification.error({\n            description: data.message\n          });\n        }\n      });\n    };\n    const handleQuery = param => {\n      if (!param) {\n        param = {\n          page: 1,\n          size: pagination.value.pageSize\n        };\n      }\n      loading.value = true;\n      axios.get(\"/business/admin/train-station/query-list\", {\n        params: {\n          page: param.page,\n          size: param.size\n        }\n      }).then(response => {\n        loading.value = false;\n        let data = response.data;\n        if (data.success) {\n          trainStations.value = data.content.list;\n          // 设置分页控件的值\n          pagination.value.current = param.page;\n          pagination.value.total = data.content.total;\n        } else {\n          notification.error({\n            description: data.message\n          });\n        }\n      });\n    };\n    const handleTableChange = pagination => {\n      // console.log(\"看看自带的分页参数都有啥：\" + pagination);\n      handleQuery({\n        page: pagination.current,\n        size: pagination.pageSize\n      });\n    };\n    onMounted(() => {\n      handleQuery({\n        page: 1,\n        size: pagination.value.pageSize\n      });\n    });\n    return {\n      trainStation,\n      visible,\n      trainStations,\n      pagination,\n      columns,\n      handleTableChange,\n      handleQuery,\n      loading,\n      onAdd,\n      handleOk,\n      onEdit,\n      onDelete\n    };\n  }\n});","map":{"version":3,"names":["defineComponent","ref","onMounted","watch","notification","axios","pinyin","TrainSelectView","name","components","setup","visible","trainStation","id","undefined","trainCode","index","namePinyin","inTime","outTime","stopTime","km","createTime","updateTime","trainStations","pagination","total","current","pageSize","loading","columns","title","dataIndex","key","value","Tool","isNotEmpty","toneType","replaceAll","immediate","onAdd","onEdit","record","window","copy","onDelete","delete","then","response","data","success","description","handleQuery","page","size","error","message","handleOk","post","param","get","params","content","list","handleTableChange"],"sources":["E:\\Desktop\\projectCode\\12306\\train\\admin\\src\\views\\main\\train-station.vue"],"sourcesContent":["<template>\r\n  <p>\r\n    <a-space>\r\n      <a-button type=\"primary\" @click=\"handleQuery()\">刷新</a-button>\r\n      <a-button type=\"primary\" @click=\"onAdd\">新增</a-button>\r\n    </a-space>\r\n  </p>\r\n  <a-table :dataSource=\"trainStations\"\r\n           :columns=\"columns\"\r\n           :pagination=\"pagination\"\r\n           @change=\"handleTableChange\"\r\n           :loading=\"loading\">\r\n    <template #bodyCell=\"{ column, record }\">\r\n      <template v-if=\"column.dataIndex === 'operation'\">\r\n        <a-space>\r\n          <a-popconfirm\r\n              title=\"删除后不可恢复，确认删除?\"\r\n              @confirm=\"onDelete(record)\"\r\n              ok-text=\"确认\" cancel-text=\"取消\">\r\n            <a style=\"color: red\">删除</a>\r\n          </a-popconfirm>\r\n          <a @click=\"onEdit(record)\">编辑</a>\r\n        </a-space>\r\n      </template>\r\n    </template>\r\n  </a-table>\r\n  <a-modal v-model:visible=\"visible\" title=\"火车车站\" @ok=\"handleOk\"\r\n           ok-text=\"确认\" cancel-text=\"取消\">\r\n    <a-form :model=\"trainStation\" :label-col=\"{span: 4}\" :wrapper-col=\"{ span: 20 }\">\r\n      <a-form-item label=\"车次编号\">\r\n        <train-select-view v-model=\"trainStation.trainCode\" width=\"50%\"></train-select-view>\r\n      </a-form-item>\r\n      <a-form-item label=\"站序\">\r\n        <a-input v-model:value=\"trainStation.index\" />\r\n      </a-form-item>\r\n      <a-form-item label=\"站名\">\r\n        <a-input v-model:value=\"trainStation.name\" />\r\n      </a-form-item>\r\n      <a-form-item label=\"站名拼音\">\r\n        <a-input v-model:value=\"trainStation.namePinyin\" disabled/>\r\n      </a-form-item>\r\n      <a-form-item label=\"进站时间\">\r\n        <a-time-picker v-model:value=\"trainStation.inTime\" valueFormat=\"HH:mm:ss\" placeholder=\"请选择时间\" />\r\n      </a-form-item>\r\n      <a-form-item label=\"出站时间\">\r\n        <a-time-picker v-model:value=\"trainStation.outTime\" valueFormat=\"HH:mm:ss\" placeholder=\"请选择时间\" />\r\n      </a-form-item>\r\n      <a-form-item label=\"停站时长\">\r\n        <a-time-picker v-model:value=\"trainStation.stopTime\" valueFormat=\"HH:mm:ss\" placeholder=\"请选择时间\" />\r\n      </a-form-item>\r\n      <a-form-item label=\"里程（公里）\">\r\n        <a-input v-model:value=\"trainStation.km\" />\r\n      </a-form-item>\r\n    </a-form>\r\n  </a-modal>\r\n</template>\r\n\r\n<script>\r\nimport {defineComponent, ref, onMounted, watch} from 'vue';\r\nimport {notification} from \"ant-design-vue\";\r\nimport axios from \"axios\";\r\nimport {pinyin} from \"pinyin-pro\";\r\nimport TrainSelectView from \"@/components/train-select\";\r\n\r\nexport default defineComponent({\r\n  name: \"train-station-view\",\r\n  components: {TrainSelectView},\r\n  setup() {\r\n    const visible = ref(false);\r\n    let trainStation = ref({\r\n      id: undefined,\r\n      trainCode: undefined,\r\n      index: undefined,\r\n      name: undefined,\r\n      namePinyin: undefined,\r\n      inTime: undefined,\r\n      outTime: undefined,\r\n      stopTime: undefined,\r\n      km: undefined,\r\n      createTime: undefined,\r\n      updateTime: undefined,\r\n    });\r\n    const trainStations = ref([]);\r\n    // 分页的三个属性名是固定的\r\n    const pagination = ref({\r\n      total: 0,\r\n      current: 1,\r\n      pageSize: 10,\r\n    });\r\n    let loading = ref(false);\r\n    const columns = [\r\n      {\r\n        title: '车次编号',\r\n        dataIndex: 'trainCode',\r\n        key: 'trainCode',\r\n      },\r\n      {\r\n        title: '站序',\r\n        dataIndex: 'index',\r\n        key: 'index',\r\n      },\r\n      {\r\n        title: '站名',\r\n        dataIndex: 'name',\r\n        key: 'name',\r\n      },\r\n      {\r\n        title: '站名拼音',\r\n        dataIndex: 'namePinyin',\r\n        key: 'namePinyin',\r\n      },\r\n      {\r\n        title: '进站时间',\r\n        dataIndex: 'inTime',\r\n        key: 'inTime',\r\n      },\r\n      {\r\n        title: '出站时间',\r\n        dataIndex: 'outTime',\r\n        key: 'outTime',\r\n      },\r\n      {\r\n        title: '停站时长',\r\n        dataIndex: 'stopTime',\r\n        key: 'stopTime',\r\n      },\r\n      {\r\n        title: '里程（公里）',\r\n        dataIndex: 'km',\r\n        key: 'km',\r\n      },\r\n      {\r\n        title: '操作',\r\n        dataIndex: 'operation'\r\n      }\r\n    ];\r\n    watch(() => trainStation.value.name, ()=>{\r\n      if (Tool.isNotEmpty(trainStation.value.name)) {\r\n        trainStation.value.namePinyin = pinyin(trainStation.value.name, { toneType: 'none'}).replaceAll(\" \", \"\");\r\n      } else {\r\n        trainStation.value.namePinyin = \"\";\r\n      }\r\n    }, {immediate: true});\r\n\r\n    const onAdd = () => {\r\n      trainStation.value = {};\r\n      visible.value = true;\r\n    };\r\n\r\n    const onEdit = (record) => {\r\n      trainStation.value = window.Tool.copy(record);\r\n      visible.value = true;\r\n    };\r\n\r\n    const onDelete = (record) => {\r\n      axios.delete(\"/business/admin/train-station/delete/\" + record.id).then((response) => {\r\n        const data = response.data;\r\n        if (data.success) {\r\n          notification.success({description: \"删除成功！\"});\r\n          handleQuery({\r\n            page: pagination.value.current,\r\n            size: pagination.value.pageSize,\r\n          });\r\n        } else {\r\n          notification.error({description: data.message});\r\n        }\r\n      });\r\n    };\r\n\r\n    const handleOk = () => {\r\n      axios.post(\"/business/admin/train-station/save\", trainStation.value).then((response) => {\r\n        let data = response.data;\r\n        if (data.success) {\r\n          notification.success({description: \"保存成功！\"});\r\n          visible.value = false;\r\n          handleQuery({\r\n            page: pagination.value.current,\r\n            size: pagination.value.pageSize\r\n          });\r\n        } else {\r\n          notification.error({description: data.message});\r\n        }\r\n      });\r\n    };\r\n\r\n    const handleQuery = (param) => {\r\n      if (!param) {\r\n        param = {\r\n          page: 1,\r\n          size: pagination.value.pageSize\r\n        };\r\n      }\r\n      loading.value = true;\r\n      axios.get(\"/business/admin/train-station/query-list\", {\r\n        params: {\r\n          page: param.page,\r\n          size: param.size\r\n        }\r\n      }).then((response) => {\r\n        loading.value = false;\r\n        let data = response.data;\r\n        if (data.success) {\r\n          trainStations.value = data.content.list;\r\n          // 设置分页控件的值\r\n          pagination.value.current = param.page;\r\n          pagination.value.total = data.content.total;\r\n        } else {\r\n          notification.error({description: data.message});\r\n        }\r\n      });\r\n    };\r\n\r\n    const handleTableChange = (pagination) => {\r\n      // console.log(\"看看自带的分页参数都有啥：\" + pagination);\r\n      handleQuery({\r\n        page: pagination.current,\r\n        size: pagination.pageSize\r\n      });\r\n    };\r\n\r\n    onMounted(() => {\r\n      handleQuery({\r\n        page: 1,\r\n        size: pagination.value.pageSize\r\n      });\r\n    });\r\n\r\n    return {\r\n      trainStation,\r\n      visible,\r\n      trainStations,\r\n      pagination,\r\n      columns,\r\n      handleTableChange,\r\n      handleQuery,\r\n      loading,\r\n      onAdd,\r\n      handleOk,\r\n      onEdit,\r\n      onDelete,\r\n    };\r\n  },\r\n});\r\n</script>\r\n"],"mappings":"AA0DA,SAAQA,eAAe,EAAEC,GAAG,EAAEC,SAAS,EAAEC,KAAK,QAAO,KAAK;AAC1D,SAAQC,YAAY,QAAO,gBAAgB;AAC3C,OAAOC,KAAI,MAAO,OAAO;AACzB,SAAQC,MAAM,QAAO,YAAY;AACjC,OAAOC,eAAc,MAAO,2BAA2B;AAEvD,eAAeP,eAAe,CAAC;EAC7BQ,IAAI,EAAE,oBAAoB;EAC1BC,UAAU,EAAE;IAACF;EAAe,CAAC;EAC7BG,KAAKA,CAAA,EAAG;IACN,MAAMC,OAAM,GAAIV,GAAG,CAAC,KAAK,CAAC;IAC1B,IAAIW,YAAW,GAAIX,GAAG,CAAC;MACrBY,EAAE,EAAEC,SAAS;MACbC,SAAS,EAAED,SAAS;MACpBE,KAAK,EAAEF,SAAS;MAChBN,IAAI,EAAEM,SAAS;MACfG,UAAU,EAAEH,SAAS;MACrBI,MAAM,EAAEJ,SAAS;MACjBK,OAAO,EAAEL,SAAS;MAClBM,QAAQ,EAAEN,SAAS;MACnBO,EAAE,EAAEP,SAAS;MACbQ,UAAU,EAAER,SAAS;MACrBS,UAAU,EAAET;IACd,CAAC,CAAC;IACF,MAAMU,aAAY,GAAIvB,GAAG,CAAC,EAAE,CAAC;IAC7B;IACA,MAAMwB,UAAS,GAAIxB,GAAG,CAAC;MACrByB,KAAK,EAAE,CAAC;MACRC,OAAO,EAAE,CAAC;MACVC,QAAQ,EAAE;IACZ,CAAC,CAAC;IACF,IAAIC,OAAM,GAAI5B,GAAG,CAAC,KAAK,CAAC;IACxB,MAAM6B,OAAM,GAAI,CACd;MACEC,KAAK,EAAE,MAAM;MACbC,SAAS,EAAE,WAAW;MACtBC,GAAG,EAAE;IACP,CAAC,EACD;MACEF,KAAK,EAAE,IAAI;MACXC,SAAS,EAAE,OAAO;MAClBC,GAAG,EAAE;IACP,CAAC,EACD;MACEF,KAAK,EAAE,IAAI;MACXC,SAAS,EAAE,MAAM;MACjBC,GAAG,EAAE;IACP,CAAC,EACD;MACEF,KAAK,EAAE,MAAM;MACbC,SAAS,EAAE,YAAY;MACvBC,GAAG,EAAE;IACP,CAAC,EACD;MACEF,KAAK,EAAE,MAAM;MACbC,SAAS,EAAE,QAAQ;MACnBC,GAAG,EAAE;IACP,CAAC,EACD;MACEF,KAAK,EAAE,MAAM;MACbC,SAAS,EAAE,SAAS;MACpBC,GAAG,EAAE;IACP,CAAC,EACD;MACEF,KAAK,EAAE,MAAM;MACbC,SAAS,EAAE,UAAU;MACrBC,GAAG,EAAE;IACP,CAAC,EACD;MACEF,KAAK,EAAE,QAAQ;MACfC,SAAS,EAAE,IAAI;MACfC,GAAG,EAAE;IACP,CAAC,EACD;MACEF,KAAK,EAAE,IAAI;MACXC,SAAS,EAAE;IACb,EACD;IACD7B,KAAK,CAAC,MAAMS,YAAY,CAACsB,KAAK,CAAC1B,IAAI,EAAE,MAAI;MACvC,IAAI2B,IAAI,CAACC,UAAU,CAACxB,YAAY,CAACsB,KAAK,CAAC1B,IAAI,CAAC,EAAE;QAC5CI,YAAY,CAACsB,KAAK,CAACjB,UAAS,GAAIX,MAAM,CAACM,YAAY,CAACsB,KAAK,CAAC1B,IAAI,EAAE;UAAE6B,QAAQ,EAAE;QAAM,CAAC,CAAC,CAACC,UAAU,CAAC,GAAG,EAAE,EAAE,CAAC;MAC1G,OAAO;QACL1B,YAAY,CAACsB,KAAK,CAACjB,UAAS,GAAI,EAAE;MACpC;IACF,CAAC,EAAE;MAACsB,SAAS,EAAE;IAAI,CAAC,CAAC;IAErB,MAAMC,KAAI,GAAIA,CAAA,KAAM;MAClB5B,YAAY,CAACsB,KAAI,GAAI,CAAC,CAAC;MACvBvB,OAAO,CAACuB,KAAI,GAAI,IAAI;IACtB,CAAC;IAED,MAAMO,MAAK,GAAKC,MAAM,IAAK;MACzB9B,YAAY,CAACsB,KAAI,GAAIS,MAAM,CAACR,IAAI,CAACS,IAAI,CAACF,MAAM,CAAC;MAC7C/B,OAAO,CAACuB,KAAI,GAAI,IAAI;IACtB,CAAC;IAED,MAAMW,QAAO,GAAKH,MAAM,IAAK;MAC3BrC,KAAK,CAACyC,MAAM,CAAC,uCAAsC,GAAIJ,MAAM,CAAC7B,EAAE,CAAC,CAACkC,IAAI,CAAEC,QAAQ,IAAK;QACnF,MAAMC,IAAG,GAAID,QAAQ,CAACC,IAAI;QAC1B,IAAIA,IAAI,CAACC,OAAO,EAAE;UAChB9C,YAAY,CAAC8C,OAAO,CAAC;YAACC,WAAW,EAAE;UAAO,CAAC,CAAC;UAC5CC,WAAW,CAAC;YACVC,IAAI,EAAE5B,UAAU,CAACS,KAAK,CAACP,OAAO;YAC9B2B,IAAI,EAAE7B,UAAU,CAACS,KAAK,CAACN;UACzB,CAAC,CAAC;QACJ,OAAO;UACLxB,YAAY,CAACmD,KAAK,CAAC;YAACJ,WAAW,EAAEF,IAAI,CAACO;UAAO,CAAC,CAAC;QACjD;MACF,CAAC,CAAC;IACJ,CAAC;IAED,MAAMC,QAAO,GAAIA,CAAA,KAAM;MACrBpD,KAAK,CAACqD,IAAI,CAAC,oCAAoC,EAAE9C,YAAY,CAACsB,KAAK,CAAC,CAACa,IAAI,CAAEC,QAAQ,IAAK;QACtF,IAAIC,IAAG,GAAID,QAAQ,CAACC,IAAI;QACxB,IAAIA,IAAI,CAACC,OAAO,EAAE;UAChB9C,YAAY,CAAC8C,OAAO,CAAC;YAACC,WAAW,EAAE;UAAO,CAAC,CAAC;UAC5CxC,OAAO,CAACuB,KAAI,GAAI,KAAK;UACrBkB,WAAW,CAAC;YACVC,IAAI,EAAE5B,UAAU,CAACS,KAAK,CAACP,OAAO;YAC9B2B,IAAI,EAAE7B,UAAU,CAACS,KAAK,CAACN;UACzB,CAAC,CAAC;QACJ,OAAO;UACLxB,YAAY,CAACmD,KAAK,CAAC;YAACJ,WAAW,EAAEF,IAAI,CAACO;UAAO,CAAC,CAAC;QACjD;MACF,CAAC,CAAC;IACJ,CAAC;IAED,MAAMJ,WAAU,GAAKO,KAAK,IAAK;MAC7B,IAAI,CAACA,KAAK,EAAE;QACVA,KAAI,GAAI;UACNN,IAAI,EAAE,CAAC;UACPC,IAAI,EAAE7B,UAAU,CAACS,KAAK,CAACN;QACzB,CAAC;MACH;MACAC,OAAO,CAACK,KAAI,GAAI,IAAI;MACpB7B,KAAK,CAACuD,GAAG,CAAC,0CAA0C,EAAE;QACpDC,MAAM,EAAE;UACNR,IAAI,EAAEM,KAAK,CAACN,IAAI;UAChBC,IAAI,EAAEK,KAAK,CAACL;QACd;MACF,CAAC,CAAC,CAACP,IAAI,CAAEC,QAAQ,IAAK;QACpBnB,OAAO,CAACK,KAAI,GAAI,KAAK;QACrB,IAAIe,IAAG,GAAID,QAAQ,CAACC,IAAI;QACxB,IAAIA,IAAI,CAACC,OAAO,EAAE;UAChB1B,aAAa,CAACU,KAAI,GAAIe,IAAI,CAACa,OAAO,CAACC,IAAI;UACvC;UACAtC,UAAU,CAACS,KAAK,CAACP,OAAM,GAAIgC,KAAK,CAACN,IAAI;UACrC5B,UAAU,CAACS,KAAK,CAACR,KAAI,GAAIuB,IAAI,CAACa,OAAO,CAACpC,KAAK;QAC7C,OAAO;UACLtB,YAAY,CAACmD,KAAK,CAAC;YAACJ,WAAW,EAAEF,IAAI,CAACO;UAAO,CAAC,CAAC;QACjD;MACF,CAAC,CAAC;IACJ,CAAC;IAED,MAAMQ,iBAAgB,GAAKvC,UAAU,IAAK;MACxC;MACA2B,WAAW,CAAC;QACVC,IAAI,EAAE5B,UAAU,CAACE,OAAO;QACxB2B,IAAI,EAAE7B,UAAU,CAACG;MACnB,CAAC,CAAC;IACJ,CAAC;IAED1B,SAAS,CAAC,MAAM;MACdkD,WAAW,CAAC;QACVC,IAAI,EAAE,CAAC;QACPC,IAAI,EAAE7B,UAAU,CAACS,KAAK,CAACN;MACzB,CAAC,CAAC;IACJ,CAAC,CAAC;IAEF,OAAO;MACLhB,YAAY;MACZD,OAAO;MACPa,aAAa;MACbC,UAAU;MACVK,OAAO;MACPkC,iBAAiB;MACjBZ,WAAW;MACXvB,OAAO;MACPW,KAAK;MACLiB,QAAQ;MACRhB,MAAM;MACNI;IACF,CAAC;EACH;AACF,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}