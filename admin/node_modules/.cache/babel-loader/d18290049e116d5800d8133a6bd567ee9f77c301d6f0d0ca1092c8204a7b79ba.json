{"ast":null,"code":"import { defineComponent, ref, onMounted } from 'vue';\nimport { notification } from \"ant-design-vue\";\nimport axios from \"axios\";\nexport default defineComponent({\n  name: \"sk-token-view\",\n  setup() {\n    const visible = ref(false);\n    let skToken = ref({\n      id: undefined,\n      date: undefined,\n      trainCode: undefined,\n      count: undefined,\n      createTime: undefined,\n      updateTime: undefined\n    });\n    const skTokens = ref([]);\n    // 分页的三个属性名是固定的\n    const pagination = ref({\n      total: 0,\n      current: 1,\n      pageSize: 10\n    });\n    let loading = ref(false);\n    const columns = [{\n      title: '日期',\n      dataIndex: 'date',\n      key: 'date'\n    }, {\n      title: '车次编号',\n      dataIndex: 'trainCode',\n      key: 'trainCode'\n    }, {\n      title: '令牌余量',\n      dataIndex: 'count',\n      key: 'count'\n    }, {\n      title: '操作',\n      dataIndex: 'operation'\n    }];\n    const onAdd = () => {\n      skToken.value = {};\n      visible.value = true;\n    };\n    const onEdit = record => {\n      skToken.value = window.Tool.copy(record);\n      visible.value = true;\n    };\n    const onDelete = record => {\n      axios.delete(\"/business/admin/sk-token/delete/\" + record.id).then(response => {\n        const data = response.data;\n        if (data.success) {\n          notification.success({\n            description: \"删除成功！\"\n          });\n          handleQuery({\n            page: pagination.value.current,\n            size: pagination.value.pageSize\n          });\n        } else {\n          notification.error({\n            description: data.message\n          });\n        }\n      });\n    };\n    const handleOk = () => {\n      axios.post(\"/business/admin/sk-token/save\", skToken.value).then(response => {\n        let data = response.data;\n        if (data.success) {\n          notification.success({\n            description: \"保存成功！\"\n          });\n          visible.value = false;\n          handleQuery({\n            page: pagination.value.current,\n            size: pagination.value.pageSize\n          });\n        } else {\n          notification.error({\n            description: data.message\n          });\n        }\n      });\n    };\n    const handleQuery = param => {\n      if (!param) {\n        param = {\n          page: 1,\n          size: pagination.value.pageSize\n        };\n      }\n      loading.value = true;\n      axios.get(\"/business/admin/sk-token/query-list\", {\n        params: {\n          page: param.page,\n          size: param.size\n        }\n      }).then(response => {\n        loading.value = false;\n        let data = response.data;\n        if (data.success) {\n          skTokens.value = data.content.list;\n          // 设置分页控件的值\n          pagination.value.current = param.page;\n          pagination.value.total = data.content.total;\n        } else {\n          notification.error({\n            description: data.message\n          });\n        }\n      });\n    };\n    const handleTableChange = page => {\n      // console.log(\"看看自带的分页参数都有啥：\" + JSON.stringify(page));\n      pagination.value.pageSize = page.pageSize;\n      handleQuery({\n        page: page.current,\n        size: page.pageSize\n      });\n    };\n    onMounted(() => {\n      handleQuery({\n        page: 1,\n        size: pagination.value.pageSize\n      });\n    });\n    return {\n      skToken,\n      visible,\n      skTokens,\n      pagination,\n      columns,\n      handleTableChange,\n      handleQuery,\n      loading,\n      onAdd,\n      handleOk,\n      onEdit,\n      onDelete\n    };\n  }\n});","map":{"version":3,"mappings":"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","names":["defineComponent","ref","onMounted","notification","axios","name","setup","visible","skToken","id","undefined","date","trainCode","count","createTime","updateTime","skTokens","pagination","total","current","pageSize","loading","columns","title","dataIndex","key","onAdd","value","onEdit","record","window","Tool","copy","onDelete","delete","then","response","data","success","description","handleQuery","page","size","error","message","handleOk","post","param","get","params","content","list","handleTableChange"],"sourceRoot":"","sources":["E:\\Desktop\\projectCode\\12306\\train\\admin\\src\\views\\main\\business\\sk-token.vue"],"sourcesContent":["<template>\n  <p>\n    <a-space>\n      <a-button type=\"primary\" @click=\"handleQuery()\">刷新</a-button>\n      <!--<a-button type=\"primary\" @click=\"onAdd\">新增</a-button>-->\n    </a-space>\n  </p>\n  <a-table :dataSource=\"skTokens\"\n           :columns=\"columns\"\n           :pagination=\"pagination\"\n           @change=\"handleTableChange\"\n           :loading=\"loading\">\n    <template #bodyCell=\"{ column, record }\">\n      <template v-if=\"column.dataIndex === 'operation'\">\n        <a-space>\n          <!--<a-popconfirm-->\n          <!--    title=\"删除后不可恢复，确认删除?\"-->\n          <!--    @confirm=\"onDelete(record)\"-->\n          <!--    ok-text=\"确认\" cancel-text=\"取消\">-->\n          <!--  <a style=\"color: red\">删除</a>-->\n          <!--</a-popconfirm>-->\n          <a @click=\"onEdit(record)\">修改令牌余量</a>\n        </a-space>\n      </template>\n    </template>\n  </a-table>\n  <a-modal v-model:visible=\"visible\" title=\"秒杀令牌\" @ok=\"handleOk\"\n           ok-text=\"确认\" cancel-text=\"取消\">\n    <a-form :model=\"skToken\" :label-col=\"{span: 4}\" :wrapper-col=\"{ span: 20 }\">\n      <a-form-item label=\"日期\">\n        <a-date-picker v-model:value=\"skToken.date\" valueFormat=\"YYYY-MM-DD\" placeholder=\"请选择日期\" disabled/>\n      </a-form-item>\n      <a-form-item label=\"车次编号\">\n        <a-input v-model:value=\"skToken.trainCode\" disabled/>\n      </a-form-item>\n      <a-form-item label=\"令牌余量\">\n        <a-input v-model:value=\"skToken.count\" />\n      </a-form-item>\n    </a-form>\n  </a-modal>\n</template>\n\n<script>\nimport { defineComponent, ref, onMounted } from 'vue';\nimport {notification} from \"ant-design-vue\";\nimport axios from \"axios\";\n\nexport default defineComponent({\n  name: \"sk-token-view\",\n  setup() {\n    const visible = ref(false);\n    let skToken = ref({\n      id: undefined,\n      date: undefined,\n      trainCode: undefined,\n      count: undefined,\n      createTime: undefined,\n      updateTime: undefined,\n    });\n    const skTokens = ref([]);\n    // 分页的三个属性名是固定的\n    const pagination = ref({\n      total: 0,\n      current: 1,\n      pageSize: 10,\n    });\n    let loading = ref(false);\n    const columns = [\n    {\n      title: '日期',\n      dataIndex: 'date',\n      key: 'date',\n    },\n    {\n      title: '车次编号',\n      dataIndex: 'trainCode',\n      key: 'trainCode',\n    },\n    {\n      title: '令牌余量',\n      dataIndex: 'count',\n      key: 'count',\n    },\n    {\n      title: '操作',\n      dataIndex: 'operation'\n    }\n    ];\n\n    const onAdd = () => {\n      skToken.value = {};\n      visible.value = true;\n    };\n\n    const onEdit = (record) => {\n      skToken.value = window.Tool.copy(record);\n      visible.value = true;\n    };\n\n    const onDelete = (record) => {\n      axios.delete(\"/business/admin/sk-token/delete/\" + record.id).then((response) => {\n        const data = response.data;\n        if (data.success) {\n          notification.success({description: \"删除成功！\"});\n          handleQuery({\n            page: pagination.value.current,\n            size: pagination.value.pageSize,\n          });\n        } else {\n          notification.error({description: data.message});\n        }\n      });\n    };\n\n    const handleOk = () => {\n      axios.post(\"/business/admin/sk-token/save\", skToken.value).then((response) => {\n        let data = response.data;\n        if (data.success) {\n          notification.success({description: \"保存成功！\"});\n          visible.value = false;\n          handleQuery({\n            page: pagination.value.current,\n            size: pagination.value.pageSize\n          });\n        } else {\n          notification.error({description: data.message});\n        }\n      });\n    };\n\n    const handleQuery = (param) => {\n      if (!param) {\n        param = {\n          page: 1,\n          size: pagination.value.pageSize\n        };\n      }\n      loading.value = true;\n      axios.get(\"/business/admin/sk-token/query-list\", {\n        params: {\n          page: param.page,\n          size: param.size\n        }\n      }).then((response) => {\n        loading.value = false;\n        let data = response.data;\n        if (data.success) {\n          skTokens.value = data.content.list;\n          // 设置分页控件的值\n          pagination.value.current = param.page;\n          pagination.value.total = data.content.total;\n        } else {\n          notification.error({description: data.message});\n        }\n      });\n    };\n\n    const handleTableChange = (page) => {\n      // console.log(\"看看自带的分页参数都有啥：\" + JSON.stringify(page));\n      pagination.value.pageSize = page.pageSize;\n      handleQuery({\n        page: page.current,\n        size: page.pageSize\n      });\n    };\n\n    onMounted(() => {\n      handleQuery({\n        page: 1,\n        size: pagination.value.pageSize\n      });\n    });\n\n    return {\n      skToken,\n      visible,\n      skTokens,\n      pagination,\n      columns,\n      handleTableChange,\n      handleQuery,\n      loading,\n      onAdd,\n      handleOk,\n      onEdit,\n      onDelete\n    };\n  },\n});\n</script>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}