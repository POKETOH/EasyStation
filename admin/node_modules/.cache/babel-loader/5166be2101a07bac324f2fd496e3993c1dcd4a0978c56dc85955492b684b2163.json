{"ast":null,"code":"import { defineComponent, ref, onMounted, watch } from 'vue';\nimport { notification } from \"ant-design-vue\";\nimport axios from \"axios\";\nimport { pinyin } from \"pinyin-pro\";\nimport dayjs from \"dayjs\";\nimport TrainSelectView from \"@/components/train-select\";\nexport default defineComponent({\n  name: \"daily-train-station-view\",\n  components: {\n    TrainSelectView\n  },\n  setup() {\n    const visible = ref(false);\n    let dailyTrainStation = ref({\n      id: undefined,\n      date: undefined,\n      trainCode: undefined,\n      index: undefined,\n      name: undefined,\n      namePinyin: undefined,\n      inTime: undefined,\n      outTime: undefined,\n      stopTime: undefined,\n      km: undefined,\n      createTime: undefined,\n      updateTime: undefined\n    });\n    const dailyTrainStations = ref([]);\n    // 分页的三个属性名是固定的\n    const pagination = ref({\n      total: 0,\n      current: 1,\n      pageSize: 10\n    });\n    let loading = ref(false);\n    let params = ref({\n      trainCode: null,\n      date: null\n    });\n    const columns = [{\n      title: '日期',\n      dataIndex: 'date',\n      key: 'date'\n    }, {\n      title: '车次编号',\n      dataIndex: 'trainCode',\n      key: 'trainCode'\n    }, {\n      title: '站序',\n      dataIndex: 'index',\n      key: 'index'\n    }, {\n      title: '站名',\n      dataIndex: 'name',\n      key: 'name'\n    }, {\n      title: '站名拼音',\n      dataIndex: 'namePinyin',\n      key: 'namePinyin'\n    }, {\n      title: '进站时间',\n      dataIndex: 'inTime',\n      key: 'inTime'\n    }, {\n      title: '出站时间',\n      dataIndex: 'outTime',\n      key: 'outTime'\n    }, {\n      title: '停站时长',\n      dataIndex: 'stopTime',\n      key: 'stopTime'\n    }, {\n      title: '里程（公里）',\n      dataIndex: 'km',\n      key: 'km'\n    }, {\n      title: '操作',\n      dataIndex: 'operation'\n    }];\n    watch(() => dailyTrainStation.value.name, () => {\n      if (Tool.isNotEmpty(dailyTrainStation.value.name)) {\n        dailyTrainStation.value.namePinyin = pinyin(dailyTrainStation.value.name, {\n          toneType: 'none'\n        }).replaceAll(\" \", \"\");\n      } else {\n        dailyTrainStation.value.namePinyin = \"\";\n      }\n    }, {\n      immediate: true\n    });\n\n    // 自动计算停车时长\n    watch(() => dailyTrainStation.value.inTime, () => {\n      let diff = dayjs(dailyTrainStation.value.outTime, 'HH:mm:ss').diff(dayjs(dailyTrainStation.value.inTime, 'HH:mm:ss'), 'seconds');\n      dailyTrainStation.value.stopTime = dayjs('00:00:00', 'HH:mm:ss').second(diff).format('HH:mm:ss');\n    }, {\n      immediate: true\n    });\n\n    // 自动计算停车时长\n    watch(() => dailyTrainStation.value.outTime, () => {\n      let diff = dayjs(dailyTrainStation.value.outTime, 'HH:mm:ss').diff(dayjs(dailyTrainStation.value.inTime, 'HH:mm:ss'), 'seconds');\n      dailyTrainStation.value.stopTime = dayjs('00:00:00', 'HH:mm:ss').second(diff).format('HH:mm:ss');\n    }, {\n      immediate: true\n    });\n    const onAdd = () => {\n      dailyTrainStation.value = {};\n      visible.value = true;\n    };\n    const onEdit = record => {\n      dailyTrainStation.value = window.Tool.copy(record);\n      visible.value = true;\n    };\n    const onDelete = record => {\n      axios.delete(\"/business/admin/daily-train-station/delete/\" + record.id).then(response => {\n        const data = response.data;\n        if (data.success) {\n          notification.success({\n            description: \"删除成功！\"\n          });\n          handleQuery({\n            page: pagination.value.current,\n            size: pagination.value.pageSize\n          });\n        } else {\n          notification.error({\n            description: data.message\n          });\n        }\n      });\n    };\n    const handleOk = () => {\n      axios.post(\"/business/admin/daily-train-station/save\", dailyTrainStation.value).then(response => {\n        let data = response.data;\n        if (data.success) {\n          notification.success({\n            description: \"保存成功！\"\n          });\n          visible.value = false;\n          handleQuery({\n            page: pagination.value.current,\n            size: pagination.value.pageSize\n          });\n        } else {\n          notification.error({\n            description: data.message\n          });\n        }\n      });\n    };\n    const handleQuery = param => {\n      if (!param) {\n        param = {\n          page: 1,\n          size: pagination.value.pageSize\n        };\n      }\n      loading.value = true;\n      axios.get(\"/business/admin/daily-train-station/query-list\", {\n        params: {\n          page: param.page,\n          size: param.size,\n          trainCode: params.value.trainCode,\n          date: params.value.date\n        }\n      }).then(response => {\n        loading.value = false;\n        let data = response.data;\n        if (data.success) {\n          dailyTrainStations.value = data.content.list;\n          // 设置分页控件的值\n          pagination.value.current = param.page;\n          pagination.value.total = data.content.total;\n        } else {\n          notification.error({\n            description: data.message\n          });\n        }\n      });\n    };\n    const handleTableChange = pagination => {\n      // console.log(\"看看自带的分页参数都有啥：\" + pagination);\n      handleQuery({\n        page: pagination.current,\n        size: pagination.pageSize\n      });\n    };\n    onMounted(() => {\n      handleQuery({\n        page: 1,\n        size: pagination.value.pageSize\n      });\n    });\n    return {\n      dailyTrainStation,\n      visible,\n      dailyTrainStations,\n      pagination,\n      columns,\n      handleTableChange,\n      handleQuery,\n      loading,\n      onAdd,\n      handleOk,\n      onEdit,\n      onDelete,\n      params\n    };\n  }\n});","map":{"version":3,"mappings":"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","names":["defineComponent","ref","onMounted","watch","notification","axios","pinyin","dayjs","TrainSelectView","name","components","setup","visible","dailyTrainStation","id","undefined","date","trainCode","index","namePinyin","inTime","outTime","stopTime","km","createTime","updateTime","dailyTrainStations","pagination","total","current","pageSize","loading","params","columns","title","dataIndex","key","value","Tool","isNotEmpty","toneType","replaceAll","immediate","diff","second","format","onAdd","onEdit","record","window","copy","onDelete","delete","then","response","data","success","description","handleQuery","page","size","error","message","handleOk","post","param","get","content","list","handleTableChange"],"sourceRoot":"","sources":["E:\\Desktop\\projectCode\\12306\\train\\admin\\src\\views\\main\\business\\daily-train-station.vue"],"sourcesContent":["<template>\n  <p>\n    <a-space>\n      <a-date-picker v-model:value=\"params.date\" valueFormat=\"YYYY-MM-DD\" placeholder=\"请选择日期\" />\n      <train-select-view v-model=\"params.trainCode\" width=\"200px\"></train-select-view>\n      <a-button type=\"primary\" @click=\"handleQuery()\">刷新</a-button>\n      <a-button type=\"primary\" @click=\"onAdd\">新增</a-button>\n    </a-space>\n  </p>\n  <a-table :dataSource=\"dailyTrainStations\"\n           :columns=\"columns\"\n           :pagination=\"pagination\"\n           @change=\"handleTableChange\"\n           :loading=\"loading\">\n    <template #bodyCell=\"{ column, record }\">\n      <template v-if=\"column.dataIndex === 'operation'\">\n        <a-space>\n          <a-popconfirm\n              title=\"删除后不可恢复，确认删除?\"\n              @confirm=\"onDelete(record)\"\n              ok-text=\"确认\" cancel-text=\"取消\">\n            <a style=\"color: red\">删除</a>\n          </a-popconfirm>\n          <a @click=\"onEdit(record)\">编辑</a>\n        </a-space>\n      </template>\n    </template>\n  </a-table>\n  <a-modal v-model:visible=\"visible\" title=\"每日车站\" @ok=\"handleOk\"\n           ok-text=\"确认\" cancel-text=\"取消\">\n    <a-form :model=\"dailyTrainStation\" :label-col=\"{span: 4}\" :wrapper-col=\"{ span: 20 }\">\n      <a-form-item label=\"日期\">\n        <a-date-picker v-model:value=\"dailyTrainStation.date\" valueFormat=\"YYYY-MM-DD\" placeholder=\"请选择日期\" />\n      </a-form-item>\n      <a-form-item label=\"车次编号\">\n        <train-select-view v-model=\"dailyTrainStation.trainCode\"></train-select-view>\n      </a-form-item>\n      <a-form-item label=\"站序\">\n        <a-input v-model:value=\"dailyTrainStation.index\" />\n      </a-form-item>\n      <a-form-item label=\"站名\">\n        <a-input v-model:value=\"dailyTrainStation.name\" />\n      </a-form-item>\n      <a-form-item label=\"站名拼音\">\n        <a-input v-model:value=\"dailyTrainStation.namePinyin\" disabled/>\n      </a-form-item>\n      <a-form-item label=\"进站时间\">\n        <a-time-picker v-model:value=\"dailyTrainStation.inTime\" valueFormat=\"HH:mm:ss\" placeholder=\"请选择时间\" />\n      </a-form-item>\n      <a-form-item label=\"出站时间\">\n        <a-time-picker v-model:value=\"dailyTrainStation.outTime\" valueFormat=\"HH:mm:ss\" placeholder=\"请选择时间\" />\n      </a-form-item>\n      <a-form-item label=\"停站时长\">\n        <a-time-picker v-model:value=\"dailyTrainStation.stopTime\" valueFormat=\"HH:mm:ss\" placeholder=\"请选择时间\" disabled/>\n      </a-form-item>\n      <a-form-item label=\"里程（公里）\">\n        <a-input v-model:value=\"dailyTrainStation.km\" />\n      </a-form-item>\n    </a-form>\n  </a-modal>\n</template>\n\n<script>\nimport {defineComponent, ref, onMounted, watch} from 'vue';\nimport {notification} from \"ant-design-vue\";\nimport axios from \"axios\";\nimport {pinyin} from \"pinyin-pro\";\nimport dayjs from \"dayjs\";\nimport TrainSelectView from \"@/components/train-select\";\n\nexport default defineComponent({\n  name: \"daily-train-station-view\",\n  components: {TrainSelectView},\n  setup() {\n    const visible = ref(false);\n    let dailyTrainStation = ref({\n      id: undefined,\n      date: undefined,\n      trainCode: undefined,\n      index: undefined,\n      name: undefined,\n      namePinyin: undefined,\n      inTime: undefined,\n      outTime: undefined,\n      stopTime: undefined,\n      km: undefined,\n      createTime: undefined,\n      updateTime: undefined,\n    });\n    const dailyTrainStations = ref([]);\n    // 分页的三个属性名是固定的\n    const pagination = ref({\n      total: 0,\n      current: 1,\n      pageSize: 10,\n    });\n    let loading = ref(false);\n    let params = ref({\n      trainCode: null,\n      date: null\n    });\n    const columns = [\n    {\n      title: '日期',\n      dataIndex: 'date',\n      key: 'date',\n    },\n    {\n      title: '车次编号',\n      dataIndex: 'trainCode',\n      key: 'trainCode',\n    },\n    {\n      title: '站序',\n      dataIndex: 'index',\n      key: 'index',\n    },\n    {\n      title: '站名',\n      dataIndex: 'name',\n      key: 'name',\n    },\n    {\n      title: '站名拼音',\n      dataIndex: 'namePinyin',\n      key: 'namePinyin',\n    },\n    {\n      title: '进站时间',\n      dataIndex: 'inTime',\n      key: 'inTime',\n    },\n    {\n      title: '出站时间',\n      dataIndex: 'outTime',\n      key: 'outTime',\n    },\n    {\n      title: '停站时长',\n      dataIndex: 'stopTime',\n      key: 'stopTime',\n    },\n    {\n      title: '里程（公里）',\n      dataIndex: 'km',\n      key: 'km',\n    },\n    {\n      title: '操作',\n      dataIndex: 'operation'\n    }\n    ];\n    watch(() => dailyTrainStation.value.name, ()=>{\n      if (Tool.isNotEmpty(dailyTrainStation.value.name)) {\n        dailyTrainStation.value.namePinyin = pinyin(dailyTrainStation.value.name, { toneType: 'none'}).replaceAll(\" \", \"\");\n      } else {\n        dailyTrainStation.value.namePinyin = \"\";\n      }\n    }, {immediate: true});\n\n    // 自动计算停车时长\n    watch(() => dailyTrainStation.value.inTime, ()=>{\n      let diff = dayjs(dailyTrainStation.value.outTime, 'HH:mm:ss').diff(dayjs(dailyTrainStation.value.inTime, 'HH:mm:ss'), 'seconds');\n      dailyTrainStation.value.stopTime = dayjs('00:00:00', 'HH:mm:ss').second(diff).format('HH:mm:ss');\n    }, {immediate: true});\n\n    // 自动计算停车时长\n    watch(() => dailyTrainStation.value.outTime, ()=>{\n      let diff = dayjs(dailyTrainStation.value.outTime, 'HH:mm:ss').diff(dayjs(dailyTrainStation.value.inTime, 'HH:mm:ss'), 'seconds');\n      dailyTrainStation.value.stopTime = dayjs('00:00:00', 'HH:mm:ss').second(diff).format('HH:mm:ss');\n    }, {immediate: true});\n\n    const onAdd = () => {\n      dailyTrainStation.value = {};\n      visible.value = true;\n    };\n\n    const onEdit = (record) => {\n      dailyTrainStation.value = window.Tool.copy(record);\n      visible.value = true;\n    };\n\n    const onDelete = (record) => {\n      axios.delete(\"/business/admin/daily-train-station/delete/\" + record.id).then((response) => {\n        const data = response.data;\n        if (data.success) {\n          notification.success({description: \"删除成功！\"});\n          handleQuery({\n            page: pagination.value.current,\n            size: pagination.value.pageSize,\n          });\n        } else {\n          notification.error({description: data.message});\n        }\n      });\n    };\n\n    const handleOk = () => {\n      axios.post(\"/business/admin/daily-train-station/save\", dailyTrainStation.value).then((response) => {\n        let data = response.data;\n        if (data.success) {\n          notification.success({description: \"保存成功！\"});\n          visible.value = false;\n          handleQuery({\n            page: pagination.value.current,\n            size: pagination.value.pageSize\n          });\n        } else {\n          notification.error({description: data.message});\n        }\n      });\n    };\n\n    const handleQuery = (param) => {\n      if (!param) {\n        param = {\n          page: 1,\n          size: pagination.value.pageSize\n        };\n      }\n      loading.value = true;\n      axios.get(\"/business/admin/daily-train-station/query-list\", {\n        params: {\n          page: param.page,\n          size: param.size,\n          trainCode: params.value.trainCode,\n          date: params.value.date\n        }\n      }).then((response) => {\n        loading.value = false;\n        let data = response.data;\n        if (data.success) {\n          dailyTrainStations.value = data.content.list;\n          // 设置分页控件的值\n          pagination.value.current = param.page;\n          pagination.value.total = data.content.total;\n        } else {\n          notification.error({description: data.message});\n        }\n      });\n    };\n\n    const handleTableChange = (pagination) => {\n      // console.log(\"看看自带的分页参数都有啥：\" + pagination);\n      handleQuery({\n        page: pagination.current,\n        size: pagination.pageSize\n      });\n    };\n\n    onMounted(() => {\n      handleQuery({\n        page: 1,\n        size: pagination.value.pageSize\n      });\n    });\n\n    return {\n      dailyTrainStation,\n      visible,\n      dailyTrainStations,\n      pagination,\n      columns,\n      handleTableChange,\n      handleQuery,\n      loading,\n      onAdd,\n      handleOk,\n      onEdit,\n      onDelete,\n      params\n    };\n  },\n});\n</script>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}