{"ast":null,"code":"import { defineComponent, ref, onMounted } from 'vue';\nimport { notification } from \"ant-design-vue\";\nimport axios from \"axios\";\nimport TrainSelectView from \"@/components/train-select\";\nimport StationSelectView from \"@/components/station-select\";\nimport dayjs from \"dayjs\";\nexport default defineComponent({\n  name: \"daily-train-ticket-view\",\n  components: {\n    StationSelectView,\n    TrainSelectView\n  },\n  setup() {\n    const visible = ref(false);\n    let dailyTrainTicket = ref({\n      id: undefined,\n      date: undefined,\n      trainCode: undefined,\n      start: undefined,\n      startPinyin: undefined,\n      startTime: undefined,\n      startIndex: undefined,\n      end: undefined,\n      endPinyin: undefined,\n      endTime: undefined,\n      endIndex: undefined,\n      ydz: undefined,\n      ydzPrice: undefined,\n      edz: undefined,\n      edzPrice: undefined,\n      rw: undefined,\n      rwPrice: undefined,\n      yw: undefined,\n      ywPrice: undefined,\n      createTime: undefined,\n      updateTime: undefined\n    });\n    const dailyTrainTickets = ref([]);\n    // 分页的三个属性名是固定的\n    const pagination = ref({\n      total: 0,\n      current: 1,\n      pageSize: 10\n    });\n    let loading = ref(false);\n    const params = ref({});\n    const columns = [{\n      title: '日期',\n      dataIndex: 'date',\n      key: 'date'\n    }, {\n      title: '车次编号',\n      dataIndex: 'trainCode',\n      key: 'trainCode'\n    }, {\n      title: '车站',\n      dataIndex: 'station'\n    }, {\n      title: '时间',\n      dataIndex: 'time'\n    }, {\n      title: '历时',\n      dataIndex: 'duration'\n    },\n    // {\n    //   title: '出发站',\n    //   dataIndex: 'start',\n    //   key: 'start',\n    // },\n    // {\n    //   title: '出发站拼音',\n    //   dataIndex: 'startPinyin',\n    //   key: 'startPinyin',\n    // },\n    // {\n    //   title: '出发时间',\n    //   dataIndex: 'startTime',\n    //   key: 'startTime',\n    // },\n    // {\n    //   title: '出发站序',\n    //   dataIndex: 'startIndex',\n    //   key: 'startIndex',\n    // },\n    // {\n    //   title: '到达站',\n    //   dataIndex: 'end',\n    //   key: 'end',\n    // },\n    // {\n    //   title: '到达站拼音',\n    //   dataIndex: 'endPinyin',\n    //   key: 'endPinyin',\n    // },\n    // {\n    //   title: '到站时间',\n    //   dataIndex: 'endTime',\n    //   key: 'endTime',\n    // },\n    // {\n    //   title: '到站站序',\n    //   dataIndex: 'endIndex',\n    //   key: 'endIndex',\n    // },\n    {\n      title: '一等座',\n      dataIndex: 'ydz',\n      key: 'ydz'\n    },\n    // {\n    //   title: '一等座票价',\n    //   dataIndex: 'ydzPrice',\n    //   key: 'ydzPrice',\n    // },\n    {\n      title: '二等座',\n      dataIndex: 'edz',\n      key: 'edz'\n    },\n    // {\n    //   title: '二等座票价',\n    //   dataIndex: 'edzPrice',\n    //   key: 'edzPrice',\n    // },\n    {\n      title: '软卧',\n      dataIndex: 'rw',\n      key: 'rw'\n    },\n    // {\n    //   title: '软卧票价',\n    //   dataIndex: 'rwPrice',\n    //   key: 'rwPrice',\n    // },\n    {\n      title: '硬卧',\n      dataIndex: 'yw',\n      key: 'yw'\n    }\n    // {\n    //   title: '硬卧票价',\n    //   dataIndex: 'ywPrice',\n    //   key: 'ywPrice',\n    // },\n    ];\n\n    const handleQuery = param => {\n      if (!param) {\n        param = {\n          page: 1,\n          size: pagination.value.pageSize\n        };\n      }\n      loading.value = true;\n      axios.get(\"/business/admin/daily-train-ticket/query-list\", {\n        params: {\n          page: param.page,\n          size: param.size,\n          trainCode: params.value.trainCode,\n          date: params.value.date,\n          start: params.value.start,\n          end: params.value.end\n        }\n      }).then(response => {\n        loading.value = false;\n        let data = response.data;\n        if (data.success) {\n          dailyTrainTickets.value = data.content.list;\n          // 设置分页控件的值\n          pagination.value.current = param.page;\n          pagination.value.total = data.content.total;\n        } else {\n          notification.error({\n            description: data.message\n          });\n        }\n      });\n    };\n    const handleTableChange = page => {\n      // console.log(\"看看自带的分页参数都有啥：\" + JSON.stringify(page));\n      pagination.value.pageSize = page.pageSize;\n      handleQuery({\n        page: page.current,\n        size: page.pageSize\n      });\n    };\n    const calDuration = (startTime, endTime) => {\n      let diff = dayjs(endTime, 'HH:mm:ss').diff(dayjs(startTime, 'HH:mm:ss'), 'seconds');\n      return dayjs('00:00:00', 'HH:mm:ss').second(diff).format('HH:mm:ss');\n    };\n    onMounted(() => {\n      handleQuery({\n        page: 1,\n        size: pagination.value.pageSize\n      });\n    });\n    return {\n      dailyTrainTicket,\n      visible,\n      dailyTrainTickets,\n      pagination,\n      columns,\n      handleTableChange,\n      handleQuery,\n      loading,\n      params,\n      calDuration\n    };\n  }\n});","map":{"version":3,"mappings":"AA4EA,SAASA,eAAe,EAAEC,GAAG,EAAEC,SAAQ,QAAS,KAAK;AACrD,SAAQC,YAAY,QAAO,gBAAgB;AAC3C,OAAOC,KAAI,MAAO,OAAO;AACzB,OAAOC,eAAc,MAAO,2BAA2B;AACvD,OAAOC,iBAAgB,MAAO,6BAA6B;AAC3D,OAAOC,KAAI,MAAO,OAAO;AAEzB,eAAeP,eAAe,CAAC;EAC7BQ,IAAI,EAAE,yBAAyB;EAC/BC,UAAU,EAAE;IAACH,iBAAiB;IAAED;EAAe,CAAC;EAChDK,KAAK,GAAG;IACN,MAAMC,OAAM,GAAIV,GAAG,CAAC,KAAK,CAAC;IAC1B,IAAIW,gBAAe,GAAIX,GAAG,CAAC;MACzBY,EAAE,EAAEC,SAAS;MACbC,IAAI,EAAED,SAAS;MACfE,SAAS,EAAEF,SAAS;MACpBG,KAAK,EAAEH,SAAS;MAChBI,WAAW,EAAEJ,SAAS;MACtBK,SAAS,EAAEL,SAAS;MACpBM,UAAU,EAAEN,SAAS;MACrBO,GAAG,EAAEP,SAAS;MACdQ,SAAS,EAAER,SAAS;MACpBS,OAAO,EAAET,SAAS;MAClBU,QAAQ,EAAEV,SAAS;MACnBW,GAAG,EAAEX,SAAS;MACdY,QAAQ,EAAEZ,SAAS;MACnBa,GAAG,EAAEb,SAAS;MACdc,QAAQ,EAAEd,SAAS;MACnBe,EAAE,EAAEf,SAAS;MACbgB,OAAO,EAAEhB,SAAS;MAClBiB,EAAE,EAAEjB,SAAS;MACbkB,OAAO,EAAElB,SAAS;MAClBmB,UAAU,EAAEnB,SAAS;MACrBoB,UAAU,EAAEpB;IACd,CAAC,CAAC;IACF,MAAMqB,iBAAgB,GAAIlC,GAAG,CAAC,EAAE,CAAC;IACjC;IACA,MAAMmC,UAAS,GAAInC,GAAG,CAAC;MACrBoC,KAAK,EAAE,CAAC;MACRC,OAAO,EAAE,CAAC;MACVC,QAAQ,EAAE;IACZ,CAAC,CAAC;IACF,IAAIC,OAAM,GAAIvC,GAAG,CAAC,KAAK,CAAC;IACxB,MAAMwC,MAAK,GAAIxC,GAAG,CAAC,CAAC,CAAC,CAAC;IACtB,MAAMyC,OAAM,GAAI,CAChB;MACEC,KAAK,EAAE,IAAI;MACXC,SAAS,EAAE,MAAM;MACjBC,GAAG,EAAE;IACP,CAAC,EACD;MACEF,KAAK,EAAE,MAAM;MACbC,SAAS,EAAE,WAAW;MACtBC,GAAG,EAAE;IACP,CAAC,EACD;MACEF,KAAK,EAAE,IAAI;MACXC,SAAS,EAAE;IACb,CAAC,EACD;MACED,KAAK,EAAE,IAAI;MACXC,SAAS,EAAE;IACb,CAAC,EACD;MACED,KAAK,EAAE,IAAI;MACXC,SAAS,EAAE;IACb,CAAC;IACD;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;MACED,KAAK,EAAE,KAAK;MACZC,SAAS,EAAE,KAAK;MAChBC,GAAG,EAAE;IACP,CAAC;IACD;IACA;IACA;IACA;IACA;IACA;MACEF,KAAK,EAAE,KAAK;MACZC,SAAS,EAAE,KAAK;MAChBC,GAAG,EAAE;IACP,CAAC;IACD;IACA;IACA;IACA;IACA;IACA;MACEF,KAAK,EAAE,IAAI;MACXC,SAAS,EAAE,IAAI;MACfC,GAAG,EAAE;IACP,CAAC;IACD;IACA;IACA;IACA;IACA;IACA;MACEF,KAAK,EAAE,IAAI;MACXC,SAAS,EAAE,IAAI;MACfC,GAAG,EAAE;IACP;IACA;IACA;IACA;IACA;IACA;IAAA,CACC;;IAGD,MAAMC,WAAU,GAAKC,KAAK,IAAK;MAC7B,IAAI,CAACA,KAAK,EAAE;QACVA,KAAI,GAAI;UACNC,IAAI,EAAE,CAAC;UACPC,IAAI,EAAEb,UAAU,CAACc,KAAK,CAACX;QACzB,CAAC;MACH;MACAC,OAAO,CAACU,KAAI,GAAI,IAAI;MACpB9C,KAAK,CAAC+C,GAAG,CAAC,+CAA+C,EAAE;QACzDV,MAAM,EAAE;UACNO,IAAI,EAAED,KAAK,CAACC,IAAI;UAChBC,IAAI,EAAEF,KAAK,CAACE,IAAI;UAChBjC,SAAS,EAAEyB,MAAM,CAACS,KAAK,CAAClC,SAAS;UACjCD,IAAI,EAAE0B,MAAM,CAACS,KAAK,CAACnC,IAAI;UACvBE,KAAK,EAAEwB,MAAM,CAACS,KAAK,CAACjC,KAAK;UACzBI,GAAG,EAAEoB,MAAM,CAACS,KAAK,CAAC7B;QACpB;MACF,CAAC,CAAC,CAAC+B,IAAI,CAAEC,QAAQ,IAAK;QACpBb,OAAO,CAACU,KAAI,GAAI,KAAK;QACrB,IAAII,IAAG,GAAID,QAAQ,CAACC,IAAI;QACxB,IAAIA,IAAI,CAACC,OAAO,EAAE;UAChBpB,iBAAiB,CAACe,KAAI,GAAII,IAAI,CAACE,OAAO,CAACC,IAAI;UAC3C;UACArB,UAAU,CAACc,KAAK,CAACZ,OAAM,GAAIS,KAAK,CAACC,IAAI;UACrCZ,UAAU,CAACc,KAAK,CAACb,KAAI,GAAIiB,IAAI,CAACE,OAAO,CAACnB,KAAK;QAC7C,OAAO;UACLlC,YAAY,CAACuD,KAAK,CAAC;YAACC,WAAW,EAAEL,IAAI,CAACM;UAAO,CAAC,CAAC;QACjD;MACF,CAAC,CAAC;IACJ,CAAC;IAED,MAAMC,iBAAgB,GAAKb,IAAI,IAAK;MAClC;MACAZ,UAAU,CAACc,KAAK,CAACX,QAAO,GAAIS,IAAI,CAACT,QAAQ;MACzCO,WAAW,CAAC;QACVE,IAAI,EAAEA,IAAI,CAACV,OAAO;QAClBW,IAAI,EAAED,IAAI,CAACT;MACb,CAAC,CAAC;IACJ,CAAC;IAED,MAAMuB,WAAU,GAAI,CAAC3C,SAAS,EAAEI,OAAO,KAAK;MAC1C,IAAIwC,IAAG,GAAIxD,KAAK,CAACgB,OAAO,EAAE,UAAU,CAAC,CAACwC,IAAI,CAACxD,KAAK,CAACY,SAAS,EAAE,UAAU,CAAC,EAAE,SAAS,CAAC;MACnF,OAAOZ,KAAK,CAAC,UAAU,EAAE,UAAU,CAAC,CAACyD,MAAM,CAACD,IAAI,CAAC,CAACE,MAAM,CAAC,UAAU,CAAC;IACtE,CAAC;IAED/D,SAAS,CAAC,MAAM;MACd4C,WAAW,CAAC;QACVE,IAAI,EAAE,CAAC;QACPC,IAAI,EAAEb,UAAU,CAACc,KAAK,CAACX;MACzB,CAAC,CAAC;IACJ,CAAC,CAAC;IAEF,OAAO;MACL3B,gBAAgB;MAChBD,OAAO;MACPwB,iBAAiB;MACjBC,UAAU;MACVM,OAAO;MACPmB,iBAAiB;MACjBf,WAAW;MACXN,OAAO;MACPC,MAAM;MACNqB;IACF,CAAC;EACH;AACF,CAAC,CAAC","names":["defineComponent","ref","onMounted","notification","axios","TrainSelectView","StationSelectView","dayjs","name","components","setup","visible","dailyTrainTicket","id","undefined","date","trainCode","start","startPinyin","startTime","startIndex","end","endPinyin","endTime","endIndex","ydz","ydzPrice","edz","edzPrice","rw","rwPrice","yw","ywPrice","createTime","updateTime","dailyTrainTickets","pagination","total","current","pageSize","loading","params","columns","title","dataIndex","key","handleQuery","param","page","size","value","get","then","response","data","success","content","list","error","description","message","handleTableChange","calDuration","diff","second","format"],"sourceRoot":"","sources":["E:\\Desktop\\projectCode\\12306\\train\\admin\\src\\views\\main\\business\\daily-train-ticket.vue"],"sourcesContent":["<template>\n  <p>\n    <a-space>\n      <train-select-view v-model=\"params.trainCode\" width=\"200px\"></train-select-view>\n      <a-date-picker v-model:value=\"params.date\" valueFormat=\"YYYY-MM-DD\" placeholder=\"请选择日期\"></a-date-picker>\n      <station-select-view v-model=\"params.start\" width=\"200px\"></station-select-view>\n      <station-select-view v-model=\"params.end\" width=\"200px\"></station-select-view>\n      <a-button type=\"primary\" @click=\"handleQuery()\">查找</a-button>\n    </a-space>\n  </p>\n  <a-table :dataSource=\"dailyTrainTickets\"\n           :columns=\"columns\"\n           :pagination=\"pagination\"\n           @change=\"handleTableChange\"\n           :loading=\"loading\">\n    <template #bodyCell=\"{ column, record }\">\n      <template v-if=\"column.dataIndex === 'operation'\">\n      </template>\n      <template v-else-if=\"column.dataIndex === 'station'\">\n        {{record.start}}<br/>\n        {{record.end}}\n      </template>\n      <template v-else-if=\"column.dataIndex === 'time'\">\n        {{record.startTime}}<br/>\n        {{record.endTime}}\n      </template>\n      <template v-else-if=\"column.dataIndex === 'duration'\">\n        {{calDuration(record.startTime, record.endTime)}}<br/>\n        <div v-if=\"record.startTime.replaceAll(':', '') >= record.endTime.replaceAll(':', '')\">\n          次日到达\n        </div>\n        <div v-else>\n          当日到达\n        </div>\n      </template>\n      <template v-else-if=\"column.dataIndex === 'ydz'\">\n        <div v-if=\"record.ydz >= 0\">\n          {{record.ydz}}<br/>\n          {{record.ydzPrice}}￥\n        </div>\n        <div v-else>\n          --\n        </div>\n      </template>\n      <template v-else-if=\"column.dataIndex === 'edz'\">\n        <div v-if=\"record.edz >= 0\">\n          {{record.edz}}<br/>\n          {{record.edzPrice}}￥\n        </div>\n        <div v-else>\n          --\n        </div>\n      </template>\n      <template v-else-if=\"column.dataIndex === 'rw'\">\n        <div v-if=\"record.rw >= 0\">\n          {{record.rw}}<br/>\n          {{record.rwPrice}}￥\n        </div>\n        <div v-else>\n          --\n        </div>\n      </template>\n      <template v-else-if=\"column.dataIndex === 'yw'\">\n        <div v-if=\"record.yw >= 0\">\n          {{record.yw}}<br/>\n          {{record.ywPrice}}￥\n        </div>\n        <div v-else>\n          --\n        </div>\n      </template>\n    </template>\n  </a-table>\n</template>\n\n<script>\nimport { defineComponent, ref, onMounted } from 'vue';\nimport {notification} from \"ant-design-vue\";\nimport axios from \"axios\";\nimport TrainSelectView from \"@/components/train-select\";\nimport StationSelectView from \"@/components/station-select\";\nimport dayjs from \"dayjs\";\n\nexport default defineComponent({\n  name: \"daily-train-ticket-view\",\n  components: {StationSelectView, TrainSelectView},\n  setup() {\n    const visible = ref(false);\n    let dailyTrainTicket = ref({\n      id: undefined,\n      date: undefined,\n      trainCode: undefined,\n      start: undefined,\n      startPinyin: undefined,\n      startTime: undefined,\n      startIndex: undefined,\n      end: undefined,\n      endPinyin: undefined,\n      endTime: undefined,\n      endIndex: undefined,\n      ydz: undefined,\n      ydzPrice: undefined,\n      edz: undefined,\n      edzPrice: undefined,\n      rw: undefined,\n      rwPrice: undefined,\n      yw: undefined,\n      ywPrice: undefined,\n      createTime: undefined,\n      updateTime: undefined,\n    });\n    const dailyTrainTickets = ref([]);\n    // 分页的三个属性名是固定的\n    const pagination = ref({\n      total: 0,\n      current: 1,\n      pageSize: 10,\n    });\n    let loading = ref(false);\n    const params = ref({});\n    const columns = [\n    {\n      title: '日期',\n      dataIndex: 'date',\n      key: 'date',\n    },\n    {\n      title: '车次编号',\n      dataIndex: 'trainCode',\n      key: 'trainCode',\n    },\n    {\n      title: '车站',\n      dataIndex: 'station',\n    },\n    {\n      title: '时间',\n      dataIndex: 'time',\n    },\n    {\n      title: '历时',\n      dataIndex: 'duration',\n    },\n    // {\n    //   title: '出发站',\n    //   dataIndex: 'start',\n    //   key: 'start',\n    // },\n    // {\n    //   title: '出发站拼音',\n    //   dataIndex: 'startPinyin',\n    //   key: 'startPinyin',\n    // },\n    // {\n    //   title: '出发时间',\n    //   dataIndex: 'startTime',\n    //   key: 'startTime',\n    // },\n    // {\n    //   title: '出发站序',\n    //   dataIndex: 'startIndex',\n    //   key: 'startIndex',\n    // },\n    // {\n    //   title: '到达站',\n    //   dataIndex: 'end',\n    //   key: 'end',\n    // },\n    // {\n    //   title: '到达站拼音',\n    //   dataIndex: 'endPinyin',\n    //   key: 'endPinyin',\n    // },\n    // {\n    //   title: '到站时间',\n    //   dataIndex: 'endTime',\n    //   key: 'endTime',\n    // },\n    // {\n    //   title: '到站站序',\n    //   dataIndex: 'endIndex',\n    //   key: 'endIndex',\n    // },\n    {\n      title: '一等座',\n      dataIndex: 'ydz',\n      key: 'ydz',\n    },\n    // {\n    //   title: '一等座票价',\n    //   dataIndex: 'ydzPrice',\n    //   key: 'ydzPrice',\n    // },\n    {\n      title: '二等座',\n      dataIndex: 'edz',\n      key: 'edz',\n    },\n    // {\n    //   title: '二等座票价',\n    //   dataIndex: 'edzPrice',\n    //   key: 'edzPrice',\n    // },\n    {\n      title: '软卧',\n      dataIndex: 'rw',\n      key: 'rw',\n    },\n    // {\n    //   title: '软卧票价',\n    //   dataIndex: 'rwPrice',\n    //   key: 'rwPrice',\n    // },\n    {\n      title: '硬卧',\n      dataIndex: 'yw',\n      key: 'yw',\n    },\n    // {\n    //   title: '硬卧票价',\n    //   dataIndex: 'ywPrice',\n    //   key: 'ywPrice',\n    // },\n    ];\n\n\n    const handleQuery = (param) => {\n      if (!param) {\n        param = {\n          page: 1,\n          size: pagination.value.pageSize\n        };\n      }\n      loading.value = true;\n      axios.get(\"/business/admin/daily-train-ticket/query-list\", {\n        params: {\n          page: param.page,\n          size: param.size,\n          trainCode: params.value.trainCode,\n          date: params.value.date,\n          start: params.value.start,\n          end: params.value.end\n        }\n      }).then((response) => {\n        loading.value = false;\n        let data = response.data;\n        if (data.success) {\n          dailyTrainTickets.value = data.content.list;\n          // 设置分页控件的值\n          pagination.value.current = param.page;\n          pagination.value.total = data.content.total;\n        } else {\n          notification.error({description: data.message});\n        }\n      });\n    };\n\n    const handleTableChange = (page) => {\n      // console.log(\"看看自带的分页参数都有啥：\" + JSON.stringify(page));\n      pagination.value.pageSize = page.pageSize;\n      handleQuery({\n        page: page.current,\n        size: page.pageSize\n      });\n    };\n\n    const calDuration = (startTime, endTime) => {\n      let diff = dayjs(endTime, 'HH:mm:ss').diff(dayjs(startTime, 'HH:mm:ss'), 'seconds');\n      return dayjs('00:00:00', 'HH:mm:ss').second(diff).format('HH:mm:ss');\n    };\n\n    onMounted(() => {\n      handleQuery({\n        page: 1,\n        size: pagination.value.pageSize\n      });\n    });\n\n    return {\n      dailyTrainTicket,\n      visible,\n      dailyTrainTickets,\n      pagination,\n      columns,\n      handleTableChange,\n      handleQuery,\n      loading,\n      params,\n      calDuration\n    };\n  },\n});\n</script>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}